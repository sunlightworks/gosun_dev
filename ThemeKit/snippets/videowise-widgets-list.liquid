{% comment %} Please do not edit this file. It is automatically updated by Videowise{% endcomment %}
{{ 'videowise-loader.css' | asset_url | stylesheet_tag }}

<div class="page-width">

  {% if isProduct == false %}
    {% assign publishedPages = shop.metafields.videowise.published-pages.value %}
    {% assign currentURL = shop.url %}

    {% if request.path.size > 1 %}
      {% assign currentURL = shop.url | append: request.path %}
    {% endif %}

    {% assign isPageWidgetFound = false %}
    {% for wpage in publishedPages %}
      {% if currentURL == wpage.url %}
        {% for widget in wpage.widgets %}
          {% if selected_widget == widget %}
            {% assign isPageWidgetFound = true %}
            <div class="reeview-app-widget" id="reeview-app-widget_{{ widget }}">
              <div class="vw__section-loader">&#x20;</div>
            </div>
          {% endif %}
        {% endfor %}
      {% endif %}
    {% endfor %}

    {% if isPageWidgetFound == false and content_for_header contains "Shopify.designMode" %}
      <div class="vw-front__section">
        <div class="vw-front__section-inner">
          <div class="vw-front__icon"></div>
          <p>Please select the video widget you would like to use in this section.</p>
        </div>
      </div>
    {% endif %}

  {% else %}
    {% assign widgets = product.metafields.videowise.widgets.value %}
    {% assign isProductWidgetFound = false %}
    {% for widget in widgets %}
      {% if selected_widget == widget %}
        {% assign isProductWidgetFound = true %}
        <div class="reeview-app-widget" id="reeview-app-widget_{{ widget }}">
          <div class="vw__section-loader">&#x20;</div>
          <script>
            setTimeout(function() {
              var elementId = '{{ widget }}';
              var widgetElementRoot = document.getElementById('reeview-app-widget_' + elementId);
              var loaderElement = widgetElementRoot.querySelector('.vw__section-loader');
              loaderElement.remove();
            }, 2000);
          </script>
        </div>
      {% endif %}
    {% endfor %}
    {% if isProductWidgetFound == false and content_for_header contains "Shopify.designMode" %}
      <div class="vw-front__section">
        <div class="vw-front__section-inner">
          <div class="vw-front__icon"></div>
          <p>Please select the video widget you would like to use in this section.</p>
        </div>
      </div>
    {% endif %}
  {% endif %}

</div>
